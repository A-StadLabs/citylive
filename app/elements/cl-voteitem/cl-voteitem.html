<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/cw-vote/cw-vote.html">


<polymer-element name="cl-voteitem" attributes="key data votes">
  <template>
    <link rel="stylesheet" href="cl-voteitem.css">
    Voorstel {{data.naam}}
    Aantal stemmen
    <core-icon-button icon="add" disabled?="{{!plusVote}}" on-tap="{{addVote}}"></core-icon-button>
    {{votes}}<core-icon-button disabled?="{{!minVote}}" icon="remove" on-tap="{{remVote}}"></core-icon-button>
  </template>
  <script>
    (function () {
      'use strict';


      Polymer({
        // define element prototype here
        ready: function(){
          this.plusVote = true;
          this.minVote = true;
        },

        addVote: function(){

          var that = this;

          if(that.plusVote){
          var addPlay = new Firebase('https://citylive.firebaseio.com/requests/'+this.key+'/votes');

            addPlay.transaction(function(currentRank) {
                   // If /users/fred/rank has never been set, currentRank will be null.
                  return currentRank+1;
                });

          that.plusVote = false;
          that.minVote = true;
          }
        },
        remVote: function(){
          var that = this;

          if(that.minVote){
          var addPlay = new Firebase('https://citylive.firebaseio.com/requests/'+this.key+'/votes');

            addPlay.transaction(function(currentRank) {
                   // If /users/fred/rank has never been set, currentRank will be null.
                  return currentRank-1;
                });

          that.minVote = false;
          that.plusVote = true;

          }
        },
      });

    })();
  </script>
</polymer-element>
